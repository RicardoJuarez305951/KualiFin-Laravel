<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tablero Kanban Semanal (Offline)</title>
    <!-- Se cambió la referencia de Tailwind a un archivo local -->
    <link href="tailwind.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .kanban-column {
            min-height: 80vh;
        }
        .task-card {
            cursor: grab;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .task-card:active {
            cursor: grabbing;
        }
        .dragging {
            opacity: 0.5;
            transform: rotate(3deg);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-900">Tablero de Módulos por Rol</h1>
            <p class="text-lg text-gray-600 mt-2">Semana del 22 al 28 de Septiembre, 2025</p>
        </header>

        <!-- Contenedor del Tablero Kanban -->
        <div id="kanban-board" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            
            <!-- Columna: Por Hacer -->
            <div class="kanban-column bg-gray-200 rounded-xl shadow-inner" data-column-id="todo">
                <h2 class="text-xl font-semibold p-4 text-gray-700 border-b-2 border-gray-300">Por Hacer</h2>
                <div class="p-4 space-y-4 task-list">
                    <!-- Las tareas se insertarán aquí dinámicamente -->
                </div>
            </div>

            <!-- Columna: En Progreso (Ricardo) -->
            <div class="kanban-column bg-blue-100 rounded-xl shadow-inner" data-column-id="in-progress-ricardo">
                <h2 class="text-xl font-semibold p-4 text-blue-800 border-b-2 border-blue-200">En Progreso (Ricardo)</h2>
                <div class="p-4 space-y-4 task-list"></div>
            </div>

            <!-- Columna: En Progreso (Adair) -->
            <div class="kanban-column bg-green-100 rounded-xl shadow-inner" data-column-id="in-progress-adair">
                <h2 class="text-xl font-semibold p-4 text-green-800 border-b-2 border-green-200">En Progreso (Adair)</h2>
                <div class="p-4 space-y-4 task-list"></div>
            </div>

            <!-- Columna: Terminado -->
            <div class="kanban-column bg-purple-100 rounded-xl shadow-inner" data-column-id="done">
                <h2 class="text-xl font-semibold p-4 text-purple-800 border-b-2 border-purple-200">Terminado</h2>
                <div class="p-4 space-y-4 task-list"></div>
            </div>
        </div>

        <!-- Sección de Referencia: Clasificaciones y Estados -->
        <div class="mt-12">
            <h2 class="text-2xl font-bold text-center mb-6">Referencia Rápida: Clasificaciones y Estados</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Clasificación de Créditos -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-lg mb-3">Clasificación de Créditos</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Activo</li>
                        <li>Con deuda</li>
                        <li>Vencido</li>
                        <li>Liquidado</li>
                    </ul>
                </div>
                <!-- Clasificación de Cartera -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-lg mb-3">Clasificación de Cartera</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Activa</li>
                        <li>Activa con Deuda</li>
                        <li>Vencida</li>
                        <li>Liquidado</li>
                        <li>Inactivo</li>
                    </ul>
                </div>
                <!-- Estados de Cliente y Colores -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-lg mb-3">Estados de Cliente y Colores</h3>
                    <p class="mb-4 font-medium text-gray-700">Prospecto → Viable → Venta Aceptada</p>
                    <div class="space-y-3">
                        <div class="flex items-center"><div class="w-5 h-5 rounded-full bg-green-500 mr-3"></div><span>Verde: Pagado</span></div>
                        <div class="flex items-center"><div class="w-5 h-5 rounded-full bg-yellow-400 mr-3"></div><span>Amarillo/Naranja: En tiempo</span></div>
                        <div class="flex items-center"><div class="w-5 h-5 rounded-full bg-red-500 mr-3"></div><span>Rojo: Falla</span></div>
                        <div class="flex items-center"><div class="w-5 h-5 rounded-full bg-blue-500 mr-3"></div><span>Azul: Adelanto</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATOS DE LAS TAREAS ---
        const tasks = [
            // Módulo Promotor
            { id: 'task-1', content: 'Programar cálculo de Mi Objetivo P/ejecutivo > Mi Objetivo P/ejercicio.', module: 'Promotor', functionality: 'Objetivos', assigned: 'Ricardo' },
            { id: 'task-2', content: 'Conectar ventas registradas con las ventas semanales de la promotora.', module: 'Promotor', functionality: 'Objetivos', assigned: 'Ricardo' },
            { id: 'task-3', content: 'Ajustar cálculo para considerar semanas de paro.', module: 'Promotor', functionality: 'Objetivos', assigned: 'Ricardo' },
            { id: 'task-4', content: 'Generar frase inspiracional según % de objetivo alcanzado.', module: 'Promotor', functionality: 'Motivación', assigned: 'Adair' },
            { id: 'task-5', content: 'Implementar carrusel/ciclado de frases en el menú principal.', module: 'Promotor', functionality: 'Motivación', assigned: 'Adair' },
            { id: 'task-6', content: 'Mostrar la fecha de la venta en el título.', module: 'Promotor', functionality: 'Ventas', assigned: 'Ricardo' },
            { id: 'task-7', content: 'Agregar mensaje de confirmación de venta.', module: 'Promotor', functionality: 'Ventas', assigned: 'Ricardo' },
            { id: 'task-8', content: 'Implementar lógica backend para pagos completos y diferidos.', module: 'Promotor', functionality: 'Pagos múltiples', assigned: 'Adair' },
            { id: 'task-9', content: 'Diseñar inputs dinámicos para múltiples pagos.', module: 'Promotor', functionality: 'Pagos múltiples', assigned: 'Adair' },
            { id: 'task-10', content: 'Aplicar colores de feedback (éxito, error, advertencia).', module: 'Promotor', functionality: 'Pagos múltiples', assigned: 'Adair' },
            { id: 'task-11', content: 'Revisar y estandarizar que todos los nombres estén en español en la UI.', module: 'Promotor', functionality: 'General', assigned: 'Adair' },
            // Módulo Supervisor
            { id: 'task-12', content: 'Hacer botones funcionales.', module: 'Supervisor', functionality: 'Objetivo', assigned: 'Ricardo' },
            { id: 'task-13', content: 'Calcular % de avance y monto total por promotor.', module: 'Supervisor', functionality: 'Cartera', assigned: 'Adair' },
            { id: 'task-14', content: 'Implementar barra visual de progreso por promotor.', module: 'Supervisor', functionality: 'Cartera', assigned: 'Adair' },
            { id: 'task-15', content: 'Definir lógica de horarios funcionales y BDD.', module: 'Supervisor', functionality: 'Venta', assigned: 'Adair' },
            { id: 'task-16', content: 'Diseñar UI para captura de horarios.', module: 'Supervisor', functionality: 'Venta', assigned: 'Adair' },
            { id: 'task-17', content: 'Mover formulario actual de Prospectados a Supervisar.', module: 'Supervisor', functionality: 'Prospectados', assigned: 'Ricardo' },
            { id: 'task-18', content: 'Implementar botones de actualizar y regresar.', module: 'Supervisor', functionality: 'Prospectados', assigned: 'Ricardo' },
            { id: 'task-19', content: 'Mostrar info capturada por promotora en check del supervisor.', module: 'Supervisor', functionality: 'Prospectados', assigned: 'Ricardo' },
            { id: 'task-20', content: 'Lógica backend de búsqueda (nombre, dirección, teléfono).', module: 'Supervisor', functionality: 'Búsqueda', assigned: 'Adair' },
            { id: 'task-21', content: 'Implementar búsquedas permisivas.', module: 'Supervisor', functionality: 'Búsqueda', assigned: 'Adair' },
            { id: 'task-22', content: 'Validar visibilidad de datos según rol.', module: 'Supervisor', functionality: 'Búsqueda', assigned: 'Adair' },
            { id: 'task-23', content: 'Maquetar formulario y tabla de resultados de búsqueda.', module: 'Supervisor', functionality: 'Búsqueda', assigned: 'Adair' },
            { id: 'task-24', content: 'Incluir apertura también para ejecutivo/supuesto.', module: 'Supervisor', functionality: 'Apertura', assigned: 'Ricardo' },
            // Módulo Ejecutivo
            { id: 'task-25', content: 'Implementar botón “V” que redirija a Desembolso.', module: 'Ejecutivo', functionality: 'Supervisor.Venta', assigned: 'Ricardo' },
            { id: 'task-26', content: 'Maquetar formato grupal de clientes para desembolso.', module: 'Ejecutivo', functionality: 'Supervisor.Venta', assigned: 'Ricardo' },
            // Módulo Desembolso
            { id: 'task-27', content: 'Programar selección de clientes, fecha y registro de falla.', module: 'Desembolso', functionality: 'Falla', assigned: 'Ricardo' },
            { id: 'task-28', content: 'Precargar datos desde sistema.', module: 'Desembolso', functionality: 'Préstamo', assigned: 'Ricardo' },
            { id: 'task-29', content: 'Agregar botones de confirmación y cancelación.', module: 'Desembolso', functionality: 'Préstamo', assigned: 'Ricardo' },
            { id: 'task-30', content: 'Diseñar UI tentativa (pendiente definición funcional).', module: 'Desembolso', functionality: 'Cobranza Semanal', assigned: 'Adair' },
            { id: 'task-31', content: 'Implementar lógica backend de Adelantos/Recuperación.', module: 'Desembolso', functionality: 'Adelantos/Recuperación', assigned: 'Ricardo' },
            { id: 'task-32', content: 'Maquetar interfaz para selección y registro.', module: 'Desembolso', functionality: 'Adelantos/Recuperación', assigned: 'Ricardo' },
            { id: 'task-33', content: 'Programar llenado automático de Desembolso Real.', module: 'Desembolso', functionality: 'Automáticos', assigned: 'Ricardo' },
            { id: 'task-34', content: 'Programar llenado automático de Recréditos.', module: 'Desembolso', functionality: 'Automáticos', assigned: 'Ricardo' },
            { id: 'task-35', content: 'Implementar canvas JS para captura de firmas.', module: 'Desembolso', functionality: 'Firmas', assigned: 'Adair' },
            { id: 'task-36', content: 'Implementar firma electrónica con validación de contraseña.', module: 'Desembolso', functionality: 'Firmas', assigned: 'Ricardo' },
        ];

        // --- LÓGICA DEL TABLERO ---
        document.addEventListener('DOMContentLoaded', () => {
            const todoColumn = document.querySelector('[data-column-id="todo"] .task-list');

            tasks.forEach(task => {
                const taskElement = createTaskElement(task);
                todoColumn.appendChild(taskElement);
            });

            setupDragAndDrop();
        });

        function createTaskElement(task) {
            const div = document.createElement('div');
            div.className = 'task-card bg-white p-4 rounded-lg shadow-md border-l-4';
            div.setAttribute('draggable', 'true');
            div.id = task.id;
            
            const borderColor = task.assigned === 'Ricardo' ? 'border-blue-500' : 'border-green-500';
            div.classList.add(borderColor);

            div.innerHTML = `
                <div class="font-bold text-gray-800">${task.functionality}</div>
                <p class="text-sm text-gray-600 mt-1 mb-3">${task.content}</p>
                <div class="flex justify-between items-center text-xs">
                    <span class="font-semibold px-2 py-1 bg-red-100 text-red-700 rounded-full">${task.module}</span>
                    <span class="font-medium text-gray-500">${task.assigned}</span>
                </div>
            `;
            return div;
        }

        function setupDragAndDrop() {
            const cards = document.querySelectorAll('.task-card');
            const columns = document.querySelectorAll('.kanban-column .task-list');

            cards.forEach(card => {
                card.addEventListener('dragstart', () => {
                    card.classList.add('dragging');
                });
                card.addEventListener('dragend', () => {
                    card.classList.remove('dragging');
                });
            });

            columns.forEach(column => {
                column.addEventListener('dragover', e => {
                    e.preventDefault();
                    const afterElement = getDragAfterElement(column, e.clientY);
                    const dragging = document.querySelector('.dragging');
                    if (dragging) {
                         if (afterElement == null) {
                            column.appendChild(dragging);
                        } else {
                            column.insertBefore(dragging, afterElement);
                        }
                    }
                });
            });
        }
        
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.task-card:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

    </script>
</body>
</html>